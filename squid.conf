# Squid proxy configuration for forwarding to Oxylabs ISP proxy
# This allows Chrome to connect locally without authentication while
# Squid handles the upstream authentication to Oxylabs

# Basic configuration
http_port 3128

# Cache settings - disable for proxy-only mode  
cache deny all
cache_store_log none

# Access control
acl localnet src 127.0.0.1/32    # localhost
acl localnet src 10.0.0.0/8      # RFC1918 private networks
acl localnet src 172.16.0.0/12   # RFC1918 private networks
acl localnet src 192.168.0.0/16  # RFC1918 private networks

# Safe ports
acl SSL_ports port 443
acl Safe_ports port 80		# http
acl Safe_ports port 21		# ftp
acl Safe_ports port 443		# https
acl Safe_ports port 70		# gopher
acl Safe_ports port 210		# wais
acl Safe_ports port 1025-65535	# unregistered ports
acl Safe_ports port 280		# http-mgmt
acl Safe_ports port 488		# gss-http
acl Safe_ports port 591		# filemaker
acl Safe_ports port 777		# multiling http

acl CONNECT method CONNECT

# Deny requests to unsafe ports and methods
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports

# Allow localhost connections (from Chrome)
http_access allow localnet
http_access allow localhost

# Deny all other access
http_access deny all

# Upstream proxy configuration - forward to Oxylabs with authentication
cache_peer isp.oxylabs.io parent 8001 0 no-query no-digest login=tyson_XvWFd:yj1h_uBKvZxTx4TqPntc
never_direct allow all

# Disable via header
via off

# Disable forwarded for header for privacy
forwarded_for off

# Error handling
error_directory /usr/share/squid/errors/en

# Logging (to stdout for container logging)
access_log stdio:/dev/stdout
cache_log /dev/stdout

# Process management
pid_filename /tmp/squid.pid

# Coredump directory
coredump_dir /var/spool/squid